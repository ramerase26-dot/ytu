<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #1a237e; color: white; text-align: center; padding: 20px; }
        .wheel { width: 300px; height: 300px; margin: 20px auto; position: relative; }
        .spin-btn { background: #FF5722; color: white; border: none; padding: 15px 30px; 
                   border-radius: 25px; font-size: 18px; cursor: pointer; margin: 20px; }
        .spin-btn:disabled { background: #666; cursor: not-allowed; }
    </style>
</head>
<body>
    <h1>ğŸ¡ Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸</h1>
    <p id="status">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...</p>
    
    <div class="wheel" id="wheel">
        <!-- Ø§Ù„Ø¹Ø¬Ù„Ø© -->
    </div>
    
    <button class="spin-btn" id="spinBtn" disabled>Ø§Ù†ØªØ¸Ø±...</button>
    <div id="result" style="display:none; margin:20px; padding:15px; background:rgba(255,255,255,0.1); border-radius:10px;"></div>
    
    <script>
        // âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª - ØºÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
        const GAS_URL = "https://script.google.com/macros/s/AKfycbyoMQb71upUXKG39ofqlghXY9xYHxFLPnVPGz4mdqyjIBamAsCb7-aIhLWU9jCEFZAd/exec";
        const TELEGRAM_BOT_NAME = "YourBotUsername";
        
        let userId = new URLSearchParams(window.location.search).get('user_id');
        let canSpin = false;
        
        function init() {
            if (!userId) {
                document.getElementById("status").innerHTML = "âŒ Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ­ÙŠØ­";
                return;
            }
            
            document.getElementById("status").innerHTML = `ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${userId}`;
            checkEligibility();
            createWheel();
        }
        
        function createWheel() {
            const wheel = document.getElementById("wheel");
            const prizes = [5000, 10000, 25000, 50000, 100000];
            const colors = ['#FF5252', '#FF4081', '#E040FB', '#7C4DFF', '#448AFF'];
            
            prizes.forEach((prize, i) => {
                const segment = document.createElement("div");
                segment.style.cssText = `
                    position: absolute;
                    width: 50%;
                    height: 50%;
                    left: 0;
                    top: 0;
                    transform-origin: bottom right;
                    transform: rotate(${i * 72}deg) skewY(${18}deg);
                    background: ${colors[i]};
                    display: flex;
                    align-items: center;
                    justify-content: center;
                `;
                
                const content = document.createElement("div");
                content.innerHTML = prize.toLocaleString();
                content.style.transform = `skewY(${-18}deg) rotate(${36}deg)`;
                
                segment.appendChild(content);
                wheel.appendChild(segment);
            });
        }
        
        async function checkEligibility() {
            try {
                const response = await fetch(GAS_URL, {
                    method: 'POST',
                    body: JSON.stringify({action: 'check', user_id: userId})
                });
                const data = await response.json();
                
                if (data.eligible) {
                    canSpin = true;
                    document.getElementById("spinBtn").disabled = false;
                    document.getElementById("spinBtn").textContent = "ğŸ¡ Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¯ÙˆÙŠØ±";
                    document.getElementById("status").innerHTML += `<br>âœ… Ù…Ø¤Ù‡Ù„ Ù„Ù„Ø¹Ø¨`;
                } else {
                    document.getElementById("status").innerHTML += `<br>âŒ ØºÙŠØ± Ù…Ø¤Ù‡Ù„: ${data.reason}`;
                }
            } catch (error) {
                document.getElementById("status").innerHTML += `<br>âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„`;
            }
        }
        
        async function spinWheel() {
            if (!canSpin) return;
            
            document.getElementById("spinBtn").disabled = true;
            document.getElementById("spinBtn").textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ¯ÙˆÙŠØ±...";
            
            const prizes = [5000, 10000, 25000, 50000, 100000];
            const prize = prizes[Math.floor(Math.random() * prizes.length)];
            
            document.getElementById("wheel").style.transform = `rotate(${1440 + Math.random() * 360}deg)`;
            
            setTimeout(async () => {
                try {
                    const response = await fetch(GAS_URL, {
                        method: 'POST',
                        body: JSON.stringify({
                            action: 'record',
                            user_id: userId,
                            prize: prize
                        })
                    });
                    
                    const result = document.getElementById("result");
                    result.style.display = "block";
                    result.innerHTML = `
                        <h3>ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ!</h3>
                        <p>ÙØ²Øª Ø¨Ø¬Ø§Ø¦Ø²Ø©: <strong>${prize.toLocaleString()} Ù†Ù‚Ø·Ø©</strong></p>
                        <p>Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ù„Ù…Ø­ÙØ¸ØªÙƒ ÙÙŠ Ø§Ù„Ø¨ÙˆØª</p>
                    `;
                    
                    canSpin = false;
                    document.getElementById("spinBtn").textContent = "ØªÙ… Ø§Ù„ØªØ¯ÙˆÙŠØ±";
                    
                } catch (error) {
                    alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„");
                }
            }, 3000);
        }
        
        document.getElementById("spinBtn").onclick = spinWheel;
        window.onload = init;
    </script>
</body>
</html>
