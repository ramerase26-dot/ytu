<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸ - Ø¬ÙˆØ§Ø¦Ø² Ø­Ù‚ÙŠÙ‚ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: url('https://i.postimg.cc/wB7MWQsq/IMG-20260129-003341-890.jpg') no-repeat center center fixed;
            background-size: cover;
            background-color: #1a1a2e;
            color: #fff;
            text-align: center;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .wheel-container {
            position: relative;
            width: 450px;
            height: 450px;
            margin: 0 auto 40px;
        }
        
        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.8);
            transition: transform 4s cubic-bezier(0.2, 0.8, 0.3, 1);
            background: #1e293b;
        }

        .wheel-segment {
            position: absolute;
            width: 50%;
            height: 50%;
            top: 0;
            left: 50%;
            transform-origin: 0% 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        .segment-content {
            position: absolute;
            width: 120px;
            text-align: center;
            color: white;
            font-weight: 900;
            font-size: 16px;
            text-shadow: 2px 2px 4px black;
            background: rgba(0, 0, 0, 0.8);
            padding: 8px 15px;
            border-radius: 50px;
            border: 2px solid rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(5px);
            white-space: nowrap;
            box-shadow: 0 4px 10px rgba(0,0,0,0.5);
            letter-spacing: 1px;
            z-index: 5;
        }
        
        .wheel-pointer {
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 50px;
            background: #ffd166;
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            z-index: 10;
            filter: drop-shadow(0 0 10px rgba(255, 209, 102, 0.8));
        }
        
        .center-circle {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #1e293b, #0f172a);
            border-radius: 50%;
            z-index: 15;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ffd166;
            font-weight: 900;
            font-size: 24px;
            border: 3px solid #ffd166;
            box-shadow: inset 0 0 20px black;
        }
        
        .spin-button {
            background: linear-gradient(to right, #ff416c, #ff4b2b);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 1.5rem;
            border-radius: 50px;
            cursor: pointer;
            margin: 20px 0;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(255, 65, 108, 0.6);
            font-family: 'Cairo', sans-serif;
            font-weight: 700;
        }
        
        .spin-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 65, 108, 0.8);
        }
        
        .spin-button:disabled {
            background: #555;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            opacity: 0.7;
        }

        .result {
            display: none;
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 20px;
            margin-top: 20px;
            border: 2px solid #ffd166;
            width: 100%;
            max-width: 450px;
        }
        
        .prize-name {
            font-size: 2rem;
            font-weight: 900;
            color: #ffd166;
            text-shadow: 0 0 20px #ffd166;
            margin: 10px 0;
        }
        
        .timer {
            font-size: 1.2rem;
            color: #ffd166;
            margin-top: 20px;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        .user-input {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #ffd166;
            color: white;
            padding: 12px 25px;
            font-size: 1.1rem;
            border-radius: 50px;
            width: 300px;
            margin-bottom: 20px;
            font-family: 'Cairo', sans-serif;
            text-align: center;
        }
        
        .user-input:focus {
            outline: none;
            border-color: #ff416c;
            box-shadow: 0 0 20px rgba(255, 65, 108, 0.5);
        }
        
        .status {
            margin-top: 15px;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 600;
            width: 100%;
            max-width: 450px;
        }
        
        .success {
            background: rgba(34, 197, 94, 0.2);
            border: 1px solid #22c55e;
            color: #86efac;
        }
        
        .error {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid #ef4444;
            color: #fca5a5;
        }
        
        @media (max-width: 500px) {
            .wheel-container {
                width: 320px;
                height: 320px;
            }
            .segment-content {
                font-size: 11px;
                width: 80px;
                padding: 5px 8px;
            }
            .prize-name {
                font-size: 1.5rem;
            }
            .user-input {
                width: 260px;
            }
        }
    </style>
</head>
<body>
    <div class="wheel-container">
        <div class="wheel" id="wheel"></div>
        <div class="wheel-pointer"></div>
        <div class="center-circle">ğŸ°</div>
    </div>
    
    <input type="text" id="userId" class="user-input" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ø¹Ø±Ù Telegram Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ" value="8497054736">
    
    <button class="spin-button" id="spinButton">
        ğŸ² Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¯ÙˆÙŠØ± ğŸ²
    </button>
    
    <div id="result" class="result">
        <div style="font-size: 1.3rem;">ğŸ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø§Ù„ØªÙŠ Ø±Ø¨Ø­ØªÙ‡Ø§:</div>
        <div class="prize-name" id="prizeDisplay"></div>
        <div id="sendStatus" style="margin-top: 15px; color: #86efac;"></div>
    </div>
    
    <div id="timer" class="timer">
        â³ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø¢Ù†
    </div>
    
    <div id="statusMessage" class="status"></div>

    <script>
        // ============================================
        // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² - ØªØ·Ø§Ø¨Ù‚ ØªÙ…Ø§Ù…Ø§Ù‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø®Ø§Ø¯Ù…
        // ============================================
        const PRIZES = [
            "10% Ø®ØµÙ…",
            "20$ Ø±ØµÙŠØ¯",
            "Ø¬ÙˆØ§Ù„",
            "Ø´Ø§Ø­Ù†",
            "Ø§Ø´ØªØ±Ø§Ùƒ",
            "Ø³Ù…Ø§Ø¹Ø§Øª",
            "ÙƒÙˆØ¨ÙˆÙ† 50$",
            "Ù‡Ø¯ÙŠØ© Ù…ÙØ§Ø¬Ø£Ø©"
        ];
        
        // Ø£Ù„ÙˆØ§Ù† Ù‚Ø·Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ø¬Ù„Ø©
        const COLORS = [
            "#FF6B6B", "#4ECDC4", "#FFB347", "#A8E6CF",
            "#FF8C94", "#6C5B7B", "#F8C291", "#786FA6"
        ];
        
        let isSpinning = false;
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxTLAN3jSgeEO0jrsC8kbxeOMAEVU7vBwlGc5DvkOuFYVBswk1ZMqhCAo4gcZuMlMvxpA/exec";

        // ============================================
        // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¹Ø¬Ù„Ø© Ù…Ø¹ Ù†ØµÙˆØµ ÙˆØ§Ø¶Ø­Ø© ÙˆØ¸Ø§Ù‡Ø±Ø©
        // ============================================
        function buildWheel() {
            const wheel = document.getElementById('wheel');
            wheel.innerHTML = '';
            
            const segmentAngle = 360 / PRIZES.length;
            
            for (let i = 0; i < PRIZES.length; i++) {
                const segment = document.createElement('div');
                segment.className = 'wheel-segment';
                
                const angle = i * segmentAngle;
                segment.style.transform = `rotate(${angle}deg)`;
                segment.style.backgroundColor = COLORS[i % COLORS.length];
                
                // Ø¥Ø¶Ø§ÙØ© ØªØ¯Ø±Ø¬ Ù„ÙˆÙ†ÙŠ
                segment.style.background = `linear-gradient(135deg, ${COLORS[i % COLORS.length]}, ${adjustColor(COLORS[i % COLORS.length], -30)})`;
                
                const content = document.createElement('div');
                content.className = 'segment-content';
                
                // Ø­Ø³Ø§Ø¨ Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ù†Øµ Ù„ÙŠÙƒÙˆÙ† Ù…Ù‚Ø±ÙˆØ¡Ø§Ù‹
                let textRotation = 90 - (angle + segmentAngle / 2);
                content.style.transform = `rotate(${textRotation}deg) translateY(-35px)`;
                content.textContent = PRIZES[i];
                
                segment.appendChild(content);
                wheel.appendChild(segment);
            }
        }
        
        // ============================================
        // ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø±Ø¬Ø© Ø§Ù„Ù„ÙˆÙ†
        // ============================================
        function adjustColor(hex, percent) {
            let r = parseInt(hex.substring(1, 3), 16);
            let g = parseInt(hex.substring(3, 5), 16);
            let b = parseInt(hex.substring(5, 7), 16);
            
            r = Math.max(0, Math.min(255, r + percent));
            g = Math.max(0, Math.min(255, g + percent));
            b = Math.max(0, Math.min(255, b + percent));
            
            return `rgb(${r}, ${g}, ${b})`;
        }
        
        // ============================================
        // Ø­Ø³Ø§Ø¨ Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªÙˆÙ‚Ù Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø¬Ø§Ø¦Ø²Ø© Ù…Ø¹ÙŠÙ†Ø©
        // ============================================
        function calculateRotationForPrize(prizeIndex) {
            const segmentAngle = 360 / PRIZES.length;
            const targetAngle = (prizeIndex * segmentAngle) + (segmentAngle / 2);
            const spins = Math.floor(Math.random() * 6) + 8; // 8-13 Ø¯ÙˆØ±Ø©
            const fullRotations = spins * 360;
            return fullRotations + (360 - targetAngle);
        }
        
        // ============================================
        // ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø¹Ø¬Ù„Ø© - Ø§Ù„Ø®Ø§Ø¯Ù… ÙŠØ®ØªØ§Ø± Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©
        // ============================================
        async function spinWheel() {
            const userId = document.getElementById('userId').value.trim();
            
            if (!userId) {
                showStatus("âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…", "error");
                return;
            }
            
            if (isNaN(userId) || userId.length < 5) {
                showStatus("âŒ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± ØµØ§Ù„Ø­", "error");
                return;
            }
            
            const spinButton = document.getElementById('spinButton');
            const resultDiv = document.getElementById('result');
            
            if (isSpinning) return;
            
            isSpinning = true;
            spinButton.disabled = true;
            spinButton.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ¯ÙˆÙŠØ±...";
            
            try {
                showStatus("ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…...", "");
                
                // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©
                const response = await fetch(`${SCRIPT_URL}?action=spin_wheel&user_id=${encodeURIComponent(userId)}`, {
                    method: 'POST',
                    mode: 'no-cors'
                });
                
                // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø®Ø§Ø¯Ù… Ù„Ù„Ø¬Ø§Ø¦Ø²Ø©
                const randomIndex = Math.floor(Math.random() * PRIZES.length);
                const selectedPrize = PRIZES[randomIndex];
                
                // ØªØ®Ø²ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø§Ø¦Ø²Ø©
                window.lastPrizeIndex = randomIndex;
                window.lastPrize = selectedPrize;
                window.lastUserId = userId;
                
                // Ø­Ø³Ø§Ø¨ Ø²Ø§ÙˆÙŠØ© Ø§Ù„ØªØ¯ÙˆÙŠØ± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
                const rotation = calculateRotationForPrize(randomIndex);
                
                // ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø¹Ø¬Ù„Ø©
                const wheel = document.getElementById('wheel');
                wheel.style.transform = `rotate(${rotation}deg)`;
                
                // Ø¨Ø¹Ø¯ Ø§Ù„ØªÙˆÙ‚ÙØŒ Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
                setTimeout(() => {
                    document.getElementById('prizeDisplay').textContent = selectedPrize;
                    resultDiv.style.display = 'block';
                    
                    spinButton.disabled = false;
                    spinButton.textContent = "ğŸ² Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¯ÙˆÙŠØ± ğŸ²";
                    isSpinning = false;
                    
                    showStatus(`âœ… ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ø±Ø¨Ø­Øª: ${selectedPrize}`, "success");
                    
                    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    sendPrizeToUser(userId, randomIndex, selectedPrize);
                    
                    // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª
                    startTimer(10);
                    
                }, 4000);
                
            } catch (error) {
                console.error(error);
                showStatus("âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…", "error");
                spinButton.disabled = false;
                spinButton.textContent = "ğŸ² Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¯ÙˆÙŠØ± ğŸ²";
                isSpinning = false;
            }
        }
        
        // ============================================
        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¹Ø¨Ø± Ø§Ù„Ø¨ÙˆØª
        // ============================================
        async function sendPrizeToUser(userId, prizeIndex, prizeName) {
            try {
                showStatus("ğŸ“¤ Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø¥Ù„Ù‰ ØªÙ„ÙŠØ¬Ø±Ø§Ù…...", "");
                
                await fetch(`${SCRIPT_URL}?action=send_to_bot&user_id=${encodeURIComponent(userId)}&prize_index=${prizeIndex}`, {
                    method: 'POST',
                    mode: 'no-cors'
                });
                
                document.getElementById('sendStatus').innerHTML = "âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø¥Ù„Ù‰ Ø­Ø³Ø§Ø¨Ùƒ ÙÙŠ ØªÙ„ÙŠØ¬Ø±Ø§Ù…";
                showStatus("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© Ø¨Ù†Ø¬Ø§Ø­!", "success");
                
            } catch (error) {
                console.error(error);
                document.getElementById('sendStatus').innerHTML = "âŒ ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¬Ø§Ø¦Ø²Ø© - Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹";
            }
        }
        
        // ============================================
        // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ø§Ù„Ø±Ø³Ø§Ù„Ø©
        // ============================================
        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            statusDiv.textContent = message;
            statusDiv.className = 'status ' + (type === "success" ? "success" : type === "error" ? "error" : "");
        }
        
        // ============================================
        // Ø§Ù„Ù…Ø¤Ù‚Øª Ø¨ÙŠÙ† Ø§Ù„Ø¯ÙˆØ±Ø§Øª
        // ============================================
        function startTimer(seconds) {
            const timerDiv = document.getElementById('timer');
            let timeLeft = seconds;
            
            timerDiv.textContent = `â³ Ø§Ù†ØªØ¸Ø± ${timeLeft} Ø«Ø§Ù†ÙŠØ© Ù„Ù„ØªØ¯ÙˆÙŠØ± Ù…Ø±Ø© Ø£Ø®Ø±Ù‰`;
            
            const interval = setInterval(() => {
                timeLeft--;
                timerDiv.textContent = `â³ Ø§Ù†ØªØ¸Ø± ${timeLeft} Ø«Ø§Ù†ÙŠØ© Ù„Ù„ØªØ¯ÙˆÙŠØ± Ù…Ø±Ø© Ø£Ø®Ø±Ù‰`;
                
                if (timeLeft <= 0) {
                    clearInterval(interval);
                    timerDiv.textContent = "âœ… ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø¢Ù†";
                }
            }, 1000);
        }
        
        // ============================================
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            buildWheel();
            document.getElementById('spinButton').addEventListener('click', spinWheel);
            showStatus("ğŸ¡ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸ - Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø²Ø± Ù„Ù„Ø¨Ø¯Ø¡", "");
        });
    </script>
</body>
</html>
